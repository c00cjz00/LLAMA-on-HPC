[2024-04-07 22:02:12,143] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
04/07/2024 22:02:14 - INFO - llmtuner.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, compute dtype: torch.float16
04/07/2024 22:02:14 - INFO - llmtuner.data.template - Add pad token: </s>
04/07/2024 22:02:14 - INFO - llmtuner.data.loader - Loading dataset demo_rlhf.json...
prompt_ids:
[887, 526, 385, 319, 29902, 20255, 29889, 887, 674, 367, 2183, 263, 3414, 29889, 887, 1818, 5706, 263, 13173, 322, 1472, 1234, 29889, 13, 12968, 29901, 29871, 233, 135, 162, 235, 175, 160, 30525, 232, 193, 142, 31549, 30210, 30742, 235, 169, 137, 31522, 30505, 235, 174, 142, 232, 152, 146, 29909, 30525, 30505, 232, 139, 148, 30745, 235, 181, 175, 31450, 30429, 30392, 31191, 31411, 31407, 235, 173, 144, 234, 133, 189, 30417, 233, 183, 154, 236, 143, 165, 232, 174, 143, 234, 153, 148, 29898, 31825, 30448, 30545, 511, 31570, 232, 131, 162, 233, 175, 193, 232, 188, 166, 30959, 234, 133, 189, 31449, 232, 188, 166, 29892, 31325, 29933, 30525, 30682, 30815, 30651, 31037, 232, 188, 166, 233, 176, 187, 236, 133, 135, 29892, 232, 143, 178, 30752, 232, 187, 182, 235, 156, 162, 234, 133, 189, 30539, 30931, 31825, 30448, 233, 139, 185, 30856, 13, 7900, 22137, 29901, 29871]
prompt:
You are an AI assistant. You will be given a task. You must generate a detailed and long answer.
 Human: 感謝方律師的回覆想在請問A方在刑事責任上是否會被認為有洗錢嫌疑(銀行法),因借款幣值為港幣,而B方可能以台幣歸還,匯入帳號為公司銀行戶口
Assistant: 
chosen_ids:
[29871, 30855, 30545, 30622, 29946, 29955, 29947, 233, 165, 160, 30383, 30481, 232, 131, 162, 30406, 30313, 233, 138, 140, 233, 153, 191, 234, 183, 135, 30495, 31117, 31175, 232, 136, 170, 30214, 31086, 236, 133, 135, 235, 139, 138, 232, 131, 162, 30406, 30834, 234, 171, 177, 236, 164, 161, 30330, 31399, 235, 182, 173, 30330, 233, 152, 187, 31180, 30990, 30980, 30577, 30834, 30214, 31295, 30495, 31086, 236, 133, 135, 31117, 31175, 30767, 30214, 232, 131, 162, 30406, 30313, 31050, 236, 157, 171, 30974, 31086, 236, 133, 135, 30214, 235, 181, 187, 235, 139, 138, 30313, 231, 189, 169, 31050, 30495, 30287, 232, 131, 142, 30534, 30651, 30429, 30577, 30990, 234, 152, 185, 31117, 31175, 30214, 232, 133, 175, 31785, 31086, 236, 133, 135, 30267, 30482, 231, 193, 160, 233, 133, 171, 30744, 235, 194, 179, 30214, 29909, 235, 139, 138, 29933, 31069, 233, 138, 140, 232, 180, 175, 30494, 30939, 30287, 31276, 235, 181, 190, 232, 131, 162, 235, 181, 187, 232, 168, 148, 234, 183, 135, 30214, 31516, 30682, 30815, 31295, 30417, 234, 183, 135, 30495, 31086, 236, 133, 135, 31117, 31175, 30214, 31969, 29909, 233, 138, 140, 31244, 31331, 29933, 232, 133, 175, 31785, 30287, 232, 131, 142, 30534, 30651, 30429, 30577, 31117, 31175, 31086, 236, 133, 135, 30214, 30847, 29933, 231, 190, 144, 30413, 31086, 236, 133, 135, 30974, 30214, 232, 140, 138, 30682, 231, 193, 160, 234, 160, 166, 231, 194, 134, 31101, 31463, 30214, 235, 132, 181, 235, 174, 142, 30545, 30963, 234, 156, 191, 31541, 31689, 31237, 31650, 30214, 235, 174, 142, 31376, 29933, 31086, 236, 133, 135, 30214, 30847, 29933, 235, 132, 181, 30592, 234, 152, 179, 235, 176, 179, 30214, 232, 140, 138, 29909, 31383, 231, 193, 160, 235, 171, 183, 235, 171, 162, 31101, 31463, 235, 174, 142, 31376, 29933, 31086, 236, 133, 135, 2]
chosen:
民法第478條：「借用人應於約定期限內，返還與借用物種類、品質、數量相同之物，未定返還期限者，借用人得隨時返還，貸與人亦得定一個月以上之相當期限，催告返還。」依您所述，A與B間應屬成立一消費借貸契約，然可能未有約定返還期限，故A應先向B催告一個月以上之期限返還，如B仍不返還時，則可依督促程序，聲請法院發支付命令，請求B返還，如B聲明異議，則A需依訴訟程序請求B返還</s>
rejected_ids:
[29871, 30855, 30545, 30622, 29946, 29955, 29947, 233, 165, 160, 30383, 30481, 232, 131, 162, 30406, 30313, 233, 138, 140, 233, 153, 191, 234, 183, 135, 30495, 31117, 31175, 232, 136, 170, 30214, 31086, 236, 133, 135, 235, 139, 138, 232, 131, 162, 30406, 30834, 234, 171, 177, 236, 164, 161, 30330, 31399, 235, 182, 173, 30330, 233, 152, 187, 31180, 30990, 30980, 30577, 30834, 30214, 31295, 30495, 31086, 236, 133, 135, 31117, 31175, 30767, 30214, 232, 131, 162, 30406, 30313, 31050, 236, 157, 171, 30974, 31086, 236, 133, 135, 30214, 235, 181, 187, 235, 139, 138, 30313, 231, 189, 169, 31050, 30495, 30287, 232, 131, 142, 30534, 30651, 30429, 30577, 30990, 234, 152, 185, 31117, 31175, 30214, 232, 133, 175, 31785, 31086, 236, 133, 135, 30267, 30482, 231, 193, 160, 233, 133, 171, 30744, 235, 194, 179, 30214, 233, 133, 171, 233, 138, 140, 30392, 30417, 31331, 232, 133, 184, 233, 175, 141, 30313, 232, 131, 162, 233, 175, 193, 30214, 31570, 31389, 233, 133, 171, 231, 193, 160, 30545, 233, 138, 140, 31086, 236, 133, 135, 233, 133, 171, 30744, 233, 175, 163, 30577, 233, 175, 193, 236, 163, 136, 30214, 30413, 31570, 233, 133, 171, 233, 181, 149, 30417, 234, 179, 192, 31450, 31502, 232, 153, 177, 233, 150, 157, 31325, 30413, 30406, 236, 133, 135, 233, 175, 193, 30214, 31570, 233, 133, 171, 30577, 232, 131, 162, 233, 175, 193, 231, 191, 191, 30392, 31295, 30495, 31117, 31175, 30577, 232, 131, 162, 235, 181, 187, 30214, 231, 193, 160, 30429, 31404, 235, 169, 146, 30495, 30214, 233, 133, 171, 30682, 30698, 31376, 232, 179, 144, 30525, 30495, 30287, 232, 131, 142, 30534, 30651, 30429, 30577, 30990, 234, 152, 185, 31117, 31175, 30214, 232, 133, 175, 31785, 31086, 236, 133, 135, 30214, 31325, 31838, 29896, 29945, 30325, 232, 136, 170, 31086, 236, 133, 135, 2]
rejected:
民法第478條：「借用人應於約定期限內，返還與借用物種類、品質、數量相同之物，未定返還期限者，借用人得隨時返還，貸與人亦得定一個月以上之相當期限，催告返還。」依您所述，您應是有向債權人借款，因此您依法應返還您所欠之款項，不因您沒有簽任何單據而不用還款，因您之借款似是未定期限之借貸，依上開規定，您可要求對方定一個月以上之相當期限，催告返還，而非15日內返還</s>
04/07/2024 22:02:35 - INFO - llmtuner.model.patcher - Gradient checkpointing enabled.
04/07/2024 22:02:35 - INFO - llmtuner.model.adapter - Fine-tuning method: LoRA
04/07/2024 22:02:40 - INFO - llmtuner.model.adapter - Merged 1 adapter(s).
04/07/2024 22:02:40 - INFO - llmtuner.model.adapter - Loaded adapter(s): ../../saves/LLaMA2-7B/lora/sft
04/07/2024 22:02:40 - INFO - llmtuner.model.loader - trainable params: 4194304 || all params: 6742609920 || trainable%: 0.0622
{'loss': 2.6458, 'grad_norm': 3.9332826137542725, 'learning_rate': 4.000000000000001e-06, 'rewards/chosen': 0.00032430648570880294, 'rewards/rejected': 0.0011256600264459848, 'rewards/accuracies': 0.3499999940395355, 'rewards/margins': -0.0008013533661141992, 'logps/rejected': -466.90692138671875, 'logps/chosen': -379.53680419921875, 'logits/rejected': 1.881943941116333, 'logits/chosen': 1.7514718770980835, 'epoch': 0.09}
{'loss': 2.627, 'grad_norm': 4.796530246734619, 'learning_rate': 9e-06, 'rewards/chosen': -0.007280244491994381, 'rewards/rejected': -0.01038347277790308, 'rewards/accuracies': 0.574999988079071, 'rewards/margins': 0.003103227587416768, 'logps/rejected': -400.19549560546875, 'logps/chosen': -326.217529296875, 'logits/rejected': 1.814085602760315, 'logits/chosen': 1.7365093231201172, 'epoch': 0.18}
{'loss': 2.6015, 'grad_norm': 4.074584007263184, 'learning_rate': 9.814586436738998e-06, 'rewards/chosen': -0.028217440471053123, 'rewards/rejected': -0.038698215037584305, 'rewards/accuracies': 0.6499999761581421, 'rewards/margins': 0.010480774566531181, 'logps/rejected': -391.8981018066406, 'logps/chosen': -317.9160461425781, 'logits/rejected': 1.8751163482666016, 'logits/chosen': 1.82784903049469, 'epoch': 0.27}
{'loss': 2.642, 'grad_norm': 7.526371002197266, 'learning_rate': 9.08484946505221e-06, 'rewards/chosen': -0.0887329950928688, 'rewards/rejected': -0.11445073038339615, 'rewards/accuracies': 0.6625000238418579, 'rewards/margins': 0.025717735290527344, 'logps/rejected': -450.8697814941406, 'logps/chosen': -379.7920227050781, 'logits/rejected': 1.8509660959243774, 'logits/chosen': 1.7686611413955688, 'epoch': 0.36}
{'loss': 2.6977, 'grad_norm': 5.668247222900391, 'learning_rate': 7.883401610574338e-06, 'rewards/chosen': -0.10840342193841934, 'rewards/rejected': -0.14129234850406647, 'rewards/accuracies': 0.7250000238418579, 'rewards/margins': 0.03288891911506653, 'logps/rejected': -375.5052185058594, 'logps/chosen': -324.9165954589844, 'logits/rejected': 1.8419520854949951, 'logits/chosen': 1.7852602005004883, 'epoch': 0.44}
{'loss': 2.5647, 'grad_norm': 4.907527446746826, 'learning_rate': 6.348983855785122e-06, 'rewards/chosen': -0.14371466636657715, 'rewards/rejected': -0.19708938896656036, 'rewards/accuracies': 0.7124999761581421, 'rewards/margins': 0.053374696522951126, 'logps/rejected': -437.22003173828125, 'logps/chosen': -378.5843811035156, 'logits/rejected': 1.8335020542144775, 'logits/chosen': 1.748810052871704, 'epoch': 0.53}
{'loss': 2.611, 'grad_norm': 4.390654563903809, 'learning_rate': 4.6587879331766465e-06, 'rewards/chosen': -0.11536748707294464, 'rewards/rejected': -0.1864139437675476, 'rewards/accuracies': 0.7749999761581421, 'rewards/margins': 0.07104646414518356, 'logps/rejected': -366.6099548339844, 'logps/chosen': -303.7522277832031, 'logits/rejected': 1.8266935348510742, 'logits/chosen': 1.7675024271011353, 'epoch': 0.62}
{'loss': 2.6866, 'grad_norm': 4.73325777053833, 'learning_rate': 3.007994550768793e-06, 'rewards/chosen': -0.1548987627029419, 'rewards/rejected': -0.23017530143260956, 'rewards/accuracies': 0.699999988079071, 'rewards/margins': 0.07527656108140945, 'logps/rejected': -408.93353271484375, 'logps/chosen': -348.18798828125, 'logits/rejected': 1.8187768459320068, 'logits/chosen': 1.7325811386108398, 'epoch': 0.71}
{'loss': 2.5344, 'grad_norm': 5.288193702697754, 'learning_rate': 1.5872342839067305e-06, 'rewards/chosen': -0.16898269951343536, 'rewards/rejected': -0.2628566324710846, 'rewards/accuracies': 0.7749999761581421, 'rewards/margins': 0.09387390315532684, 'logps/rejected': -398.2770080566406, 'logps/chosen': -333.1064147949219, 'logits/rejected': 1.8117759227752686, 'logits/chosen': 1.7249794006347656, 'epoch': 0.8}
{'loss': 2.5972, 'grad_norm': 4.189705848693848, 'learning_rate': 5.60573907988124e-07, 'rewards/chosen': -0.1828136146068573, 'rewards/rejected': -0.2549818158149719, 'rewards/accuracies': 0.75, 'rewards/margins': 0.07216817140579224, 'logps/rejected': -387.5452880859375, 'logps/chosen': -337.67138671875, 'logits/rejected': 1.8067138195037842, 'logits/chosen': 1.748880386352539, 'epoch': 0.89}
{'eval_loss': 2.5845823287963867, 'eval_runtime': 53.9004, 'eval_samples_per_second': 1.855, 'eval_steps_per_second': 1.855, 'eval_rewards/chosen': -0.18485349416732788, 'eval_rewards/rejected': -0.284964382648468, 'eval_rewards/accuracies': 0.7799999713897705, 'eval_rewards/margins': 0.10011090338230133, 'eval_logps/rejected': -424.4540710449219, 'eval_logps/chosen': -343.4878234863281, 'eval_logits/rejected': 1.8210307359695435, 'eval_logits/chosen': 1.736427903175354, 'epoch': 0.89}
{'loss': 2.606, 'grad_norm': 6.397880554199219, 'learning_rate': 4.657026981834623e-08, 'rewards/chosen': -0.17315760254859924, 'rewards/rejected': -0.2499367892742157, 'rewards/accuracies': 0.6875, 'rewards/margins': 0.07677917182445526, 'logps/rejected': -370.38665771484375, 'logps/chosen': -303.5809631347656, 'logits/rejected': 1.8035030364990234, 'logits/chosen': 1.7051184177398682, 'epoch': 0.98}
{'train_runtime': 1007.6893, 'train_samples_per_second': 0.893, 'train_steps_per_second': 0.111, 'train_loss': 2.6204641503947124, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  train_loss               =     2.6205
  train_runtime            = 0:16:47.68
  train_samples_per_second =      0.893
  train_steps_per_second   =      0.111
Figure saved at: ../../saves/LLaMA2-7B/lora/dpo/training_loss.png
Figure saved at: ../../saves/LLaMA2-7B/lora/dpo/training_eval_loss.png
Figure saved at: ../../saves/LLaMA2-7B/lora/dpo/training_rewards_accuracies.png
***** eval metrics *****
  epoch                   =        1.0
  eval_logits/chosen      =     1.7364
  eval_logits/rejected    =      1.821
  eval_logps/chosen       =  -343.4878
  eval_logps/rejected     =  -424.4541
  eval_loss               =     2.5846
  eval_rewards/accuracies =       0.78
  eval_rewards/chosen     =    -0.1849
  eval_rewards/margins    =     0.1001
  eval_rewards/rejected   =     -0.285
  eval_runtime            = 0:00:53.94
  eval_samples_per_second =      1.854
  eval_steps_per_second   =      1.854
