[2024-04-07 19:32:07,328] [INFO] [real_accelerator.py:191:get_accelerator] Setting ds_accelerator to cuda (auto detect)
04/07/2024 19:32:09 - INFO - llmtuner.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1, distributed training: False, compute dtype: torch.float16
04/07/2024 19:32:09 - INFO - llmtuner.data.template - Add pad token: </s>
04/07/2024 19:32:09 - INFO - llmtuner.data.loader - Loading dataset demo_rlhf.json...
prompt_ids:
[887, 526, 385, 319, 29902, 20255, 29889, 887, 674, 367, 2183, 263, 3414, 29889, 887, 1818, 5706, 263, 13173, 322, 1472, 1234, 29889, 13, 12968, 29901, 29871, 233, 135, 162, 235, 175, 160, 30525, 232, 193, 142, 31549, 30210, 30742, 235, 169, 137, 31522, 30505, 235, 174, 142, 232, 152, 146, 29909, 30525, 30505, 232, 139, 148, 30745, 235, 181, 175, 31450, 30429, 30392, 31191, 31411, 31407, 235, 173, 144, 234, 133, 189, 30417, 233, 183, 154, 236, 143, 165, 232, 174, 143, 234, 153, 148, 29898, 31825, 30448, 30545, 511, 31570, 232, 131, 162, 233, 175, 193, 232, 188, 166, 30959, 234, 133, 189, 31449, 232, 188, 166, 29892, 31325, 29933, 30525, 30682, 30815, 30651, 31037, 232, 188, 166, 233, 176, 187, 236, 133, 135, 29892, 232, 143, 178, 30752, 232, 187, 182, 235, 156, 162, 234, 133, 189, 30539, 30931, 31825, 30448, 233, 139, 185, 30856, 13, 7900, 22137, 29901, 29871]
prompt:
You are an AI assistant. You will be given a task. You must generate a detailed and long answer.
 Human: 感謝方律師的回覆想在請問A方在刑事責任上是否會被認為有洗錢嫌疑(銀行法),因借款幣值為港幣,而B方可能以台幣歸還,匯入帳號為公司銀行戶口
Assistant: 
chosen_ids:
[29871, 30855, 30545, 30622, 29946, 29955, 29947, 233, 165, 160, 30383, 30481, 232, 131, 162, 30406, 30313, 233, 138, 140, 233, 153, 191, 234, 183, 135, 30495, 31117, 31175, 232, 136, 170, 30214, 31086, 236, 133, 135, 235, 139, 138, 232, 131, 162, 30406, 30834, 234, 171, 177, 236, 164, 161, 30330, 31399, 235, 182, 173, 30330, 233, 152, 187, 31180, 30990, 30980, 30577, 30834, 30214, 31295, 30495, 31086, 236, 133, 135, 31117, 31175, 30767, 30214, 232, 131, 162, 30406, 30313, 31050, 236, 157, 171, 30974, 31086, 236, 133, 135, 30214, 235, 181, 187, 235, 139, 138, 30313, 231, 189, 169, 31050, 30495, 30287, 232, 131, 142, 30534, 30651, 30429, 30577, 30990, 234, 152, 185, 31117, 31175, 30214, 232, 133, 175, 31785, 31086, 236, 133, 135, 30267, 30482, 231, 193, 160, 233, 133, 171, 30744, 235, 194, 179, 30214, 29909, 235, 139, 138, 29933, 31069, 233, 138, 140, 232, 180, 175, 30494, 30939, 30287, 31276, 235, 181, 190, 232, 131, 162, 235, 181, 187, 232, 168, 148, 234, 183, 135, 30214, 31516, 30682, 30815, 31295, 30417, 234, 183, 135, 30495, 31086, 236, 133, 135, 31117, 31175, 30214, 31969, 29909, 233, 138, 140, 31244, 31331, 29933, 232, 133, 175, 31785, 30287, 232, 131, 142, 30534, 30651, 30429, 30577, 31117, 31175, 31086, 236, 133, 135, 30214, 30847, 29933, 231, 190, 144, 30413, 31086, 236, 133, 135, 30974, 30214, 232, 140, 138, 30682, 231, 193, 160, 234, 160, 166, 231, 194, 134, 31101, 31463, 30214, 235, 132, 181, 235, 174, 142, 30545, 30963, 234, 156, 191, 31541, 31689, 31237, 31650, 30214, 235, 174, 142, 31376, 29933, 31086, 236, 133, 135, 30214, 30847, 29933, 235, 132, 181, 30592, 234, 152, 179, 235, 176, 179, 30214, 232, 140, 138, 29909, 31383, 231, 193, 160, 235, 171, 183, 235, 171, 162, 31101, 31463, 235, 174, 142, 31376, 29933, 31086, 236, 133, 135, 2]
chosen:
民法第478條：「借用人應於約定期限內，返還與借用物種類、品質、數量相同之物，未定返還期限者，借用人得隨時返還，貸與人亦得定一個月以上之相當期限，催告返還。」依您所述，A與B間應屬成立一消費借貸契約，然可能未有約定返還期限，故A應先向B催告一個月以上之期限返還，如B仍不返還時，則可依督促程序，聲請法院發支付命令，請求B返還，如B聲明異議，則A需依訴訟程序請求B返還</s>
rejected_ids:
[29871, 30855, 30545, 30622, 29946, 29955, 29947, 233, 165, 160, 30383, 30481, 232, 131, 162, 30406, 30313, 233, 138, 140, 233, 153, 191, 234, 183, 135, 30495, 31117, 31175, 232, 136, 170, 30214, 31086, 236, 133, 135, 235, 139, 138, 232, 131, 162, 30406, 30834, 234, 171, 177, 236, 164, 161, 30330, 31399, 235, 182, 173, 30330, 233, 152, 187, 31180, 30990, 30980, 30577, 30834, 30214, 31295, 30495, 31086, 236, 133, 135, 31117, 31175, 30767, 30214, 232, 131, 162, 30406, 30313, 31050, 236, 157, 171, 30974, 31086, 236, 133, 135, 30214, 235, 181, 187, 235, 139, 138, 30313, 231, 189, 169, 31050, 30495, 30287, 232, 131, 142, 30534, 30651, 30429, 30577, 30990, 234, 152, 185, 31117, 31175, 30214, 232, 133, 175, 31785, 31086, 236, 133, 135, 30267, 30482, 231, 193, 160, 233, 133, 171, 30744, 235, 194, 179, 30214, 233, 133, 171, 233, 138, 140, 30392, 30417, 31331, 232, 133, 184, 233, 175, 141, 30313, 232, 131, 162, 233, 175, 193, 30214, 31570, 31389, 233, 133, 171, 231, 193, 160, 30545, 233, 138, 140, 31086, 236, 133, 135, 233, 133, 171, 30744, 233, 175, 163, 30577, 233, 175, 193, 236, 163, 136, 30214, 30413, 31570, 233, 133, 171, 233, 181, 149, 30417, 234, 179, 192, 31450, 31502, 232, 153, 177, 233, 150, 157, 31325, 30413, 30406, 236, 133, 135, 233, 175, 193, 30214, 31570, 233, 133, 171, 30577, 232, 131, 162, 233, 175, 193, 231, 191, 191, 30392, 31295, 30495, 31117, 31175, 30577, 232, 131, 162, 235, 181, 187, 30214, 231, 193, 160, 30429, 31404, 235, 169, 146, 30495, 30214, 233, 133, 171, 30682, 30698, 31376, 232, 179, 144, 30525, 30495, 30287, 232, 131, 142, 30534, 30651, 30429, 30577, 30990, 234, 152, 185, 31117, 31175, 30214, 232, 133, 175, 31785, 31086, 236, 133, 135, 30214, 31325, 31838, 29896, 29945, 30325, 232, 136, 170, 31086, 236, 133, 135, 2]
rejected:
民法第478條：「借用人應於約定期限內，返還與借用物種類、品質、數量相同之物，未定返還期限者，借用人得隨時返還，貸與人亦得定一個月以上之相當期限，催告返還。」依您所述，您應是有向債權人借款，因此您依法應返還您所欠之款項，不因您沒有簽任何單據而不用還款，因您之借款似是未定期限之借貸，依上開規定，您可要求對方定一個月以上之相當期限，催告返還，而非15日內返還</s>
04/07/2024 19:32:30 - INFO - llmtuner.model.patcher - Gradient checkpointing enabled.
04/07/2024 19:32:30 - INFO - llmtuner.model.adapter - Fine-tuning method: LoRA
04/07/2024 19:32:30 - INFO - llmtuner.model.loader - trainable params: 4194304 || all params: 6742609920 || trainable%: 0.0622
{'loss': 1.8222, 'grad_norm': 0.2230241298675537, 'learning_rate': 5e-06, 'rewards/chosen': -0.17544452846050262, 'rewards/rejected': -0.17981773614883423, 'rewards/accuracies': 0.512499988079071, 'rewards/margins': 0.004373206291347742, 'logps/rejected': -1.7981773614883423, 'logps/chosen': -1.7544453144073486, 'logits/rejected': 2.3152666091918945, 'logits/chosen': 2.1345672607421875, 'sft_loss': 1.7544453144073486, 'odds_ratio_loss': 0.677287220954895, 'epoch': 0.09}
{'loss': 1.8146, 'grad_norm': 0.3033122718334198, 'learning_rate': 1e-05, 'rewards/chosen': -0.1747659295797348, 'rewards/rejected': -0.18110178411006927, 'rewards/accuracies': 0.512499988079071, 'rewards/margins': 0.006335851736366749, 'logps/rejected': -1.8110177516937256, 'logps/chosen': -1.7476590871810913, 'logits/rejected': 2.227062225341797, 'logits/chosen': 2.1198599338531494, 'sft_loss': 1.7476590871810913, 'odds_ratio_loss': 0.6694097518920898, 'epoch': 0.18}
{'loss': 1.7743, 'grad_norm': 0.2572856843471527, 'learning_rate': 9.711304610594104e-06, 'rewards/chosen': -0.17086383700370789, 'rewards/rejected': -0.18082813918590546, 'rewards/accuracies': 0.612500011920929, 'rewards/margins': 0.009964315220713615, 'logps/rejected': -1.8082813024520874, 'logps/chosen': -1.7086384296417236, 'logits/rejected': 2.3025460243225098, 'logits/chosen': 2.2324390411376953, 'sft_loss': 1.7086384296417236, 'odds_ratio_loss': 0.6563905477523804, 'epoch': 0.27}
{'loss': 1.816, 'grad_norm': 0.32084178924560547, 'learning_rate': 8.8785564535221e-06, 'rewards/chosen': -0.17480912804603577, 'rewards/rejected': -0.17901940643787384, 'rewards/accuracies': 0.4749999940395355, 'rewards/margins': 0.004210267215967178, 'logps/rejected': -1.790193796157837, 'logps/chosen': -1.7480911016464233, 'logits/rejected': 2.2808241844177246, 'logits/chosen': 2.150259494781494, 'sft_loss': 1.7480911016464233, 'odds_ratio_loss': 0.6789766550064087, 'epoch': 0.36}
{'loss': 1.8673, 'grad_norm': 0.3663167357444763, 'learning_rate': 7.597919750177168e-06, 'rewards/chosen': -0.17956912517547607, 'rewards/rejected': -0.1773221343755722, 'rewards/accuracies': 0.44999998807907104, 'rewards/margins': -0.0022469914983958006, 'logps/rejected': -1.7732212543487549, 'logps/chosen': -1.7956912517547607, 'logits/rejected': 2.2660412788391113, 'logits/chosen': 2.188619613647461, 'sft_loss': 1.7956912517547607, 'odds_ratio_loss': 0.7163669466972351, 'epoch': 0.44}
{'loss': 1.7124, 'grad_norm': 0.3751629889011383, 'learning_rate': 6.0172800652631706e-06, 'rewards/chosen': -0.16458287835121155, 'rewards/rejected': -0.17056693136692047, 'rewards/accuracies': 0.512499988079071, 'rewards/margins': 0.005984061397612095, 'logps/rejected': -1.7056694030761719, 'logps/chosen': -1.6458286046981812, 'logits/rejected': 2.2438831329345703, 'logits/chosen': 2.1218180656433105, 'sft_loss': 1.6458286046981812, 'odds_ratio_loss': 0.665396511554718, 'epoch': 0.53}
{'loss': 1.7656, 'grad_norm': 0.6778109073638916, 'learning_rate': 4.319166754518768e-06, 'rewards/chosen': -0.16980738937854767, 'rewards/rejected': -0.17473918199539185, 'rewards/accuracies': 0.5249999761581421, 'rewards/margins': 0.004931790754199028, 'logps/rejected': -1.747391939163208, 'logps/chosen': -1.6980739831924438, 'logits/rejected': 2.2266032695770264, 'logits/chosen': 2.148649215698242, 'sft_loss': 1.6980739831924438, 'odds_ratio_loss': 0.6756048202514648, 'epoch': 0.62}
{'loss': 1.8288, 'grad_norm': 0.5663048028945923, 'learning_rate': 2.8525827848495912e-06, 'rewards/chosen': -0.17583510279655457, 'rewards/rejected': -0.17667874693870544, 'rewards/accuracies': 0.5249999761581421, 'rewards/margins': 0.0008436436764895916, 'logps/rejected': -1.7667872905731201, 'logps/chosen': -1.7583509683609009, 'logits/rejected': 2.209430456161499, 'logits/chosen': 2.0787088871002197, 'sft_loss': 1.7583509683609009, 'odds_ratio_loss': 0.7043518424034119, 'epoch': 0.71}
{'loss': 1.7125, 'grad_norm': 0.3893602192401886, 'learning_rate': 1.4644660940672628e-06, 'rewards/chosen': -0.16442924737930298, 'rewards/rejected': -0.16834062337875366, 'rewards/accuracies': 0.6000000238418579, 'rewards/margins': 0.003911369014531374, 'logps/rejected': -1.6834062337875366, 'logps/chosen': -1.6442924737930298, 'logits/rejected': 2.2020506858825684, 'logits/chosen': 2.0732202529907227, 'sft_loss': 1.6442924737930298, 'odds_ratio_loss': 0.681726336479187, 'epoch': 0.8}
{'loss': 1.7322, 'grad_norm': 0.3923327624797821, 'learning_rate': 4.846263383773364e-07, 'rewards/chosen': -0.166563481092453, 'rewards/rejected': -0.17285920679569244, 'rewards/accuracies': 0.574999988079071, 'rewards/margins': 0.006295724306255579, 'logps/rejected': -1.7285919189453125, 'logps/chosen': -1.6656347513198853, 'logits/rejected': 2.18334698677063, 'logits/chosen': 2.1125028133392334, 'sft_loss': 1.6656347513198853, 'odds_ratio_loss': 0.6660120487213135, 'epoch': 0.89}
{'eval_loss': 1.7525826692581177, 'eval_runtime': 33.1187, 'eval_samples_per_second': 3.019, 'eval_steps_per_second': 3.019, 'eval_rewards/chosen': -0.1685713231563568, 'eval_rewards/rejected': -0.17468807101249695, 'eval_rewards/accuracies': 0.5899999737739563, 'eval_rewards/margins': 0.006116763222962618, 'eval_logps/rejected': -1.7468810081481934, 'eval_logps/chosen': -1.6857131719589233, 'eval_logits/rejected': 2.2307422161102295, 'eval_logits/chosen': 2.1072089672088623, 'eval_sft_loss': 1.6857131719589233, 'eval_odds_ratio_loss': 0.6686947345733643, 'epoch': 0.89}
{'loss': 1.7459, 'grad_norm': 0.47231534123420715, 'learning_rate': 2.6213605709525803e-08, 'rewards/chosen': -0.16785213351249695, 'rewards/rejected': -0.17320284247398376, 'rewards/accuracies': 0.5874999761581421, 'rewards/margins': 0.005350693129003048, 'logps/rejected': -1.7320282459259033, 'logps/chosen': -1.6785215139389038, 'logits/rejected': 2.1892342567443848, 'logits/chosen': 2.0410773754119873, 'sft_loss': 1.6785215139389038, 'odds_ratio_loss': 0.6740087270736694, 'epoch': 0.98}
{'train_runtime': 806.8665, 'train_samples_per_second': 1.115, 'train_steps_per_second': 0.139, 'train_loss': 1.7815401894705636, 'epoch': 1.0}
***** train metrics *****
  epoch                    =        1.0
  train_loss               =     1.7815
  train_runtime            = 0:13:26.86
  train_samples_per_second =      1.115
  train_steps_per_second   =      0.139
Figure saved at: ../../saves/LLaMA2-7B/lora/orpo/training_loss.png
Figure saved at: ../../saves/LLaMA2-7B/lora/orpo/training_eval_loss.png
Figure saved at: ../../saves/LLaMA2-7B/lora/orpo/training_rewards_accuracies.png
Figure saved at: ../../saves/LLaMA2-7B/lora/orpo/training_sft_loss.png
***** eval metrics *****
  epoch                   =        1.0
  eval_logits/chosen      =     2.1072
  eval_logits/rejected    =     2.2307
  eval_logps/chosen       =    -1.6857
  eval_logps/rejected     =    -1.7469
  eval_loss               =     1.7526
  eval_odds_ratio_loss    =     0.6687
  eval_rewards/accuracies =       0.59
  eval_rewards/chosen     =    -0.1686
  eval_rewards/margins    =     0.0061
  eval_rewards/rejected   =    -0.1747
  eval_runtime            = 0:00:33.12
  eval_samples_per_second =      3.019
  eval_sft_loss           =     1.6857
  eval_steps_per_second   =      3.019
